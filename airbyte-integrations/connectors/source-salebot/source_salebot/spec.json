{
  "documentationUrl" : "https://docsurl.com",
  "connectionSpecification" : {
    "$schema" : "http://json-schema.org/draft-07/schema#",
    "title" : "Salebot Spec",
    "type" : "object",
    "required" : [
      "api_key",
      "date_range"
    ],
    "properties" : {
      "api_key" : {
        "title" : "Токен доступа",
        "description" : "Токен доступа можно получить в личном каибнете по этой инструкции: https://docs.salebot.pro/api-v-konstruktore-salebot.pro/api-konstruktora#kak-sgenerirovat-api-key",
        "type" : "string",
        "airbyte_secret" : true,
        "order" : 0
      },
      "group" : {
        "title" : "Идентификатор группы для стрима списка подписчиков",
        "description" : "ID группы вк, к которой привязан подписчик для фильтрации по группе. Необходим для фильтрации по группе, без него стрим работает без этой фильтрации",
        "type" : "string",
        "order" : 1,
        "examples" : [
          "matematikandrei_bot"
        ],
        "always_show": true
      },
      "tag" : {
        "title" : "Тег группы для стрима списка подписчиков",
        "description" : "Tag, который был указан на подписочной странице. Необходим для фильтрации по тегу, без него стрим работает без этой фильтрации",
        "type" : "string",
        "order" : 2,
        "examples" : [
          "воронка_аа_вк_2"
        ],
        "always_show": true
      },
      "client_type" : {
        "title" : "Идентификатор мессенджера для стрима списка подписчиков",
        "description" : "Идентификатор мессенджера, для которого нужно узнать список подписчиков. Если ничего не передать - выведет всех клиентов",
        "type" : "integer",
        "order" : 3,
        "examples" : [
          "воронка_аа_вк_2"
        ],
        "always_show": true
      },
      "q" : {
        "title" : "query условия на поиск переменных",
        "description" : "Должно быть валидной json-строкой, как в примерах. Обязательно только при использовании поиска по переменным",
        "type" : "string",
        "order" : 4,
        "examples" : [
          "{\"result\": \"ok\", \"var\": \"дом\", \"var\": \"60\"}",
          "{\"name\": {\"_in\": [\"Joe\", \"Jane\", \"Donald\"]}}"
        ],
        "always_show": true
      },
      "search_in" : {
        "title" : "Сущность для поиска по переменным",
        "description" : "По переменным какой сущности искать, если не передать ищет по переменным клиента, может принимать значение order. Обязательно только при использовании поиска по переменным",
        "type" : "string",
        "order" : 5,
        "enum": [
          "client",
          "order"
        ],
        "default": "client",
        "always_show": true
      },
      "include_all" : {
        "title" : "Тип выполнения условий поиска по переменным",
        "description" : "false -- должно совпасть хоть одно условие, true -- все. Обязательно только при использовании поиска по переменным",
        "type" : "boolean",
        "order" : 6,
        "default": true,
        "always_show": true
      },
      "date_range" : {
        "title" : "Диапазон дат",
        "description" : "Выберите период дат, который нужно загрузить",
        "type" : "object",
        "order" : 7,
        "oneOf" : [
          {
            "type" : "object",
            "title" : "Произвольный диапазон дат",
            "required" : [
              "date_from",
              "date_to",
              "date_range_type"
            ],
            "properties" : {
              "date_from" : {
                "title" : "Дата начала",
                "type" : "string",
                "description" : "Дата начала в формате ГГГГ-ММ-ДД.",
                "pattern" : "^$|^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
                "pattern_descriptor" : "YYYY-MM-DD",
                "examples" : [
                  "2023-01-01"
                ],
                "format" : "date",
                "order" : 0
              },
              "date_to" : {
                "title" : "Дата окончания",
                "type" : "string",
                "description" : "Дата окончания в формате ГГГГ-ММ-ДД.",
                "pattern" : "^$|^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
                "examples" : [
                  "2023-01-30"
                ],
                "pattern_descriptor" : "YYYY-MM-DD",
                "format" : "date",
                "order" : 1
              },
              "date_range_type" : {
                "type" : "string",
                "title" : "Тип диапазона дат",
                "description" : "Произвольная дата",
                "const" : "custom_date",
                "order" : 2
              }
            }
          },
          {
            "type" : "object",
            "title" : "Последние N дней",
            "required" : [
              "last_days_count",
              "should_load_today",
              "date_range_type"
            ],
            "properties" : {
              "last_days_count" : {
                "title" : "Количество последних дней",
                "type" : "integer",
                "description" : "Количество последних дней без учёта сегодняшнего дня.",
                "minimum" : 0,
                "maximum" : 3650,
                "examples" : [
                  30
                ],
                "order" : 0
              },
              "should_load_today" : {
                "title" : "Загружать сегодня?",
                "type" : "boolean",
                "description" : "Следует ли загружать данные за сегодняшний день в качестве даты окончания? Если нет, датой окончания будет вчерашний день.",
                "order" : 1,
                "default" : false
              },
              "date_range_type" : {
                "type" : "string",
                "title" : "Тип диапазона дат",
                "description" : "Последние N дней",
                "const" : "last_n_days",
                "order" : 2
              }
            }
          },
          {
            "type" : "object",
            "title" : "С даты начала по сегодня",
            "description" : "Загрузка данных с даты начала по сегодняшний день. Только с этой опцией возможна инкрементальная синхронизация.",
            "required" : [
              "date_from",
              "should_load_today",
              "date_range_type"
            ],
            "properties" : {
              "date_from" : {
                "title" : "Дата начала",
                "type" : "string",
                "description" : "Дата начала в формате ГГГГ-ММ-ДД.",
                "pattern" : "^$|^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
                "pattern_descriptor" : "YYYY-MM-DD",
                "examples" : [
                  "2023-01-01"
                ],
                "format" : "date",
                "order" : 0
              },
              "should_load_today" : {
                "title" : "Загружать сегодня?",
                "type" : "boolean",
                "description" : "Следует ли загружать данные за сегодняшний день в качестве даты окончания? Если нет, датой окончания будет вчерашний день.",
                "order" : 1,
                "default" : false
              },
              "date_range_type" : {
                "type" : "string",
                "title" : "Тип диапазона дат",
                "description" : "С даты начала по сегодня",
                "const" : "from_start_date_to_today",
                "order" : 2
              }
            }
          }
        ]
      }
    }
  }
}
